/// <reference path="../pb_data/types.d.ts" />

routerAdd('GET', '/api/snapshot', async (c) => {
  const snapshot = mocks.exportMocks()
  // Return the combined collection data as JSON
  return c.json(200, snapshot)
})

$app.rootCmd.addCommand(
  new Command({
    use: 'apply-mocks',
    run: async (cmd, args) => {
      const mocks = require(`${__hooks}/mocks.js`)
      mocks.applyMocks()
    }
  })
)

$app.rootCmd.addCommand(
  new Command({
    use: 'export-mocks',
    run: async (cmd, args) => {
      const mocks = require(`${__hooks}/mocks.js`)
      const snapshot = mocks.exportMocks()
      console.log(toString(snapshot))
    }
  })
)
